import { expect, test } from "vitest";
import { deserializeState } from "./serde";

test("parse antoher pako string", () => {
  expect(
    deserializeState(
      "pako:eNrNVE1PhDAQ_SvK2RhYdz140miiB_WgRi9cBpjVaumQtqir4b_bDwosy-oePZCW6cx7bz7a6DuNlAaNaXRitiWWJFd-T5VmJJT_eWEF3psvA2kMS-AKD7z1HDi_Qf1CxejgAnMOEi85ZcAfQTLIuKXRssbG-Lwz_KhIak_waZbYWFft-kVUmm1iPUsHb4laNbFfBJQWMI3OquqwBCbSyHhzynu-NqBcXTPVMhWg4WFV-UhvtmqA1950miRpZGl1WSW7hIia89Z_trO_DWCiwJB3RYrZek9Uo3HO78OMrOGNg1IhwT490FqyrNbhJK-lRKGdlFsq0ElZMqmGJsfgt1MYAj9HADkJHVBvUCl4Dijd3xRQrVB2Xbs3Z-LZwelAMLAxdYdQOGtGxBGEZbAUlL1irltI1y67cfVYr_j2Woyb1CU2mIOjIz8HoVg7xzST_ZwtQkeTOHY-zntdeoe5pQV_agjD2DdoHNI1aF35YrFV-TzeUD6f_xPl3WXalH28KdsmuS57iPnLtI6lDOa0r2GampeGvaFd2ydkOvet0VfIOe09keTFfo_S3YQxTncvBkDuef2rj2YWm6Z9V1Aq7xU30Q8uoAZ0"
    )
  ).toMatchInlineSnapshot(`"{"state":{"memory":{"options":{"hideSidebar":false,"hideCallMethod":false,"hideDeclareGlobalVariable":true},"viewport":{"x":0,"y":0,"zoom":1},"methodCalls":{"0":{"name":"App.main","localVariables":{"myList":{"dataType":"List","value":"@11"},"tmp1":{"dataType":"List","value":null},"tmp2":{"dataType":"List","value":null}},"index":0,"position":{"x":0,"y":0}}},"variables":{},"klasses":{"List":{"attributes":{"current":"Node","first":"Node"}},"Node":{"attributes":{"next":"Node","content":"Message"}},"Message":{"attributes":{"username":"String","text":"String","isRead":"boolean"}}},"objects":{"@11":{"klass":"List","attributes":{"current":{"dataType":"Node","value":"@33"},"first":{"dataType":"Node","value":"@33"}},"position":{"x":250,"y":100}},"@33":{"klass":"Node","attributes":{"next":{"dataType":"Node","value":null},"content":{"dataType":"Message","value":"@55"}},"position":{"x":400,"y":100}},"@44":{"klass":"Node","attributes":{"next":{"dataType":"Node","value":null},"content":{"dataType":"Message","value":null}},"position":{"x":600,"y":100}},"@55":{"klass":"Message","attributes":{"username":{"dataType":"String","value":"\\"mike\\""},"text":{"dataType":"String","value":"\\"Hello World!\\""},"isRead":{"dataType":"boolean","value":true}},"position":{"x":400,"y":250}}}}},"version":0}"`);
});

test("parse pako of Linked List string", () => {
    expect(deserializeState(
        "pako:eNq1lk1v2zgQhv9K1rcFWpVDDodkLptbe9iPQxfYSy4URaVqLSuQ5Gyzgf_7jqwPJ5YVJHELw5BEisOXj17OcPVwvWpa38br1SXflrGs6vv-vrpti2rT9A9fiix-5n_qa27I_bqJu3fXq7si_ntb1W3_0ne-CG69H67_VVXJt9C9-W3tmyYO0X4vmmGIb9u6SLft2BO2dR03XWf_1p9VxtJ4fF7UzYlmjnrcuuumOzyemmUTv5-IFapNy3P_lX6Noe_-IzaNvxljTk-nQm6bWG98GffjPnPf5mYftB2netSW9bwPbbt9_Go_8RDvSpCM2uaZN3nunR-m3WOcpO-jLSN82E_l_76_jfPV3vn1tmvebNfr3SPALxrE-ryRzhiRB5sGmynkVRy-x0uDRGWU1w6NDz4TIRtI31ZN0ZnvYCuwiVRGSydRAQoCHHz2HhOSGoQ1ZEkLR7CPcELeHN-kaMEfL12FEdbJXGWZA6IQbI_i2E7H0SY7PQ2WYiDrhJIQyHmDi0gkUoL8pkTUghc-EgGlEqOMQxJaSWddD2Qu8ucBOfFZ3w4kQrAmmBSVRUVpvggEbQdEggJrLKLTExF2DxkJ5FCydQhtj2Qu8ychGffYGwmwbBODcyIQqSzCIgGDJlHaONCK16lBDwC4GdAQsBmk4p-gHsDca08BPNbzTMJ7eKy2LL7FMcsdVjZlukNKfDLqk1-vq1-eH5dNZeowTgqpPoD8INQFiEslnomwsIsIEimsFcIQIuDETEmbWCkEyg6Y1NoMppnZ8XxmX6u3INuejQtejUsrpiKo200OLO-lkZbqMGqDKNGBII09rbl1z6eV10XmX8_rnyJe3MQvbfPb2dzw1dwsmASBtCV0Bu1UvthaieBMLQwKTTRWr0gujaBTlWkTfE4_AlssyzdQ-7htLy5_PZuYeTUxQJewZziVKS0tOTkWfOg2puVcJsFy1dPg-uPTna8Ln65HDFdZ8EhRpWxIh2IseNMZrewRNsfJdn7uOimPZegEgAUKZTjjHhLHe0q0NOQM8JGEu9Dt3p0oEj26KytTTSoPLmRZkD49UllsQlUypqXaOPPJglgjEquQuCaikdZpNdEUmHAZVCiUMHyYALWkdqAc66aPLXar_wFTSdLd"
    )).toMatchInlineSnapshot(`"{"state":{"memory":{"options":{"hideSidebar":false},"viewport":{"x":0,"y":0,"zoom":1},"klasses":{"List":{"attributes":{"current":"ListNode","first":"ListNode","last":"ListNode"}},"ListNode":{"attributes":{"next":"ListNode","contentObject":"Message"}},"Message":{"attributes":{"username":"String","text":"String","date":"String"}}},"objects":{"@062e58fda7ffa9ae":{"klass":"List","attributes":{"current":{"dataType":"ListNode","value":null},"first":{"dataType":"ListNode","value":"@a729770fc8bc8d34"},"last":{"dataType":"ListNode","value":"@e373a5947acad0cd"}},"position":{"x":18.237529243140614,"y":-4.625108768650961}},"@a729770fc8bc8d34":{"klass":"ListNode","attributes":{"next":{"dataType":"ListNode","value":"@70892f3dd9166cc8"},"contentObject":{"dataType":"Message","value":"@b4c6890321c69a74"}},"position":{"x":246.4890244500964,"y":133.7379460532989}},"@70892f3dd9166cc8":{"klass":"ListNode","attributes":{"next":{"dataType":"ListNode","value":"@e373a5947acad0cd"},"contentObject":{"dataType":"Message","value":"@e1c87c7b438436bf"}},"position":{"x":486.48213187844954,"y":118.67216942061648}},"@e373a5947acad0cd":{"klass":"ListNode","attributes":{"next":{"dataType":"ListNode","value":null},"contentObject":{"dataType":"Message","value":"@9427ec990c663de1"}},"position":{"x":747.3579153061515,"y":47.147619892323206}},"@b4c6890321c69a74":{"klass":"Message","attributes":{"username":{"value":"mike","dataType":"String"},"text":{"value":"Hallo!","dataType":"String"},"date":{"value":"2023/12/03 10:30","dataType":"String"}},"position":{"x":261.20880076441415,"y":328.82004223202557}},"@e1c87c7b438436bf":{"klass":"Message","attributes":{"username":{"value":"joe","dataType":"String"},"text":{"value":"Hu","dataType":"String"},"date":{"value":"2023/12/03 10:31","dataType":"String"}},"position":{"x":538.8066721918616,"y":331.20574424910654}},"@9427ec990c663de1":{"klass":"Message","attributes":{"username":{"value":"frida","dataType":"String"},"text":{"value":"Wie gehts?","dataType":"String"},"date":{"value":"2023/12/03 10:34","dataType":"String"}},"position":{"x":817.4165864974814,"y":320.0460074056661}},"@e69be15b3d57caf6":{"klass":"Message","attributes":{"username":{"value":"emma","dataType":"String"},"text":{"value":"Gut :)","dataType":"String"},"date":{"value":"2023/12/03 10:37","dataType":"String"}},"position":{"x":149.6631533528692,"y":-128.88198218964519}}},"variables":{"@dca46e3b249940c8":{"name":"messages","value":"@062e58fda7ffa9ae","position":{"x":-125.11631037791415,"y":-6.527697176877949},"dataType":"List"},"@82b563fc9cddc2ab":{"name":"incomingMessage","value":"@e69be15b3d57caf6","position":{"x":-170.83469544728953,"y":-104.37334030790213},"dataType":"List"}}}},"version":0}"`)
})

test("parse pako string", () => {
  expect(
    deserializeState(
      "pako:eNptUEESgjAM_EvPHvTqUR_gAY9cAgaoloZJA4oOfze04IwzHDrZbHY3k5pPboKAYG6OCltsiceEqRNLPqSmsTfM9BXASlTgAk673AwWnx2xJNFLy17ZcalvolbhYVY-HISAS9rJeuDxyrisBRG2RS_r3GE1R_4LNYRt3WwOSvKCPo0uxR1LhdO8NtNgX29vGcD1GC2raooeigFRFG8EtlA4_BEtSkO3MziXqGgakIN-13z5ZL4ndnbd"
    )
  ).toMatchInlineSnapshot(`"{"state":{"memory":{"options":{"hideSidebar":false},"viewport":{"x":0,"y":0,"zoom":1},"klasses":{"BinaryTree":{"attributes":{"left":"BinaryTree","right":"BinaryTree","content":"Object"}},"String":{"attributes":{"value":"String"}}},"objects":{},"variables":{},"methodCalls":{}}},"version":0}"`);
});
